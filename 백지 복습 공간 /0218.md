# Day4

### for 문에서 return

for문에서 return을 사용하면 바깥의 함수가 종료된다. break를 포함하고 바깥에 return 까지 한다고 보면 됨

### While Stack Pop 조합

stack을 순회하면서 값으로 뭔가를 처리하는 로직

```python
while stack and stack[-1] < what :
	value = stack.pop()
	...
```

### Deque

파이썬 Queue 역할을 하는 친구

### 내부에서만 사용할때

메소드, 변수명에 `_`를 붙여서 사용할 것(PEP)

### Heapq

`우선순위 큐`를 사용하고 싶을 때 사용한다. 우선순위 큐는 요소를 추가하면 자동으로 정렬해주는 큐임. 

- python에서는 heapq로 구현할 수 있으며 기본으로 min heap을 지원함. 만약 max heap을 사용하고 싶으면 item을 넣을 때 -를 붙여서 값을 역순으로 넣으면 됨
- heapq는 list를 이용해서 구현할 수 있음. 참고로 heapq는 값을 중복으로 지원해주지 않아서 tuple형태로 값을 넣으면 된다(아래 코드 참고)

[참고][https://www.daleseo.com/python-heapq/](https://www.daleseo.com/python-heapq/)

```python
import heapq

heap = []
#heapq.heappush(heap, 값) 
#heapq.heappush(heap, (값1, 값2)) #tuple로 넣으면 좌측부터 값을 비교해서 넣어줌

#만약 넣을 값이 1로 겹친다면, tuple로 만들어서 우측에 index를 넣어주는 것도 방법
heapq.heappush(heap, (1,3))
heapq.heappush(heap, (1,2))
```

### 파이썬이 느린 또다른 이유

GIL은 자원을 여러 쓰레드가 건드리지 못하게 함. 이유는 초창기에 CPython의 동시성 관리를 편하게 해주고 쓰레드 세이프하게 만들기 위함이라고 ㅎ

### Growth Factor

그로스 팩터는 메모리 추가할당시 얼마나 받을 것인지에 대한 수치

### Hashing 함수

기본적으로 해시테이블은 key가 해싱되서 메모리에 관리됨. 이때 해싱된 값이 같아서 서로 같은 메모리 공간을 차지하게 되는 충돌 문제가 생길 수 있음. 그래서 충분히 메모리를 할당시켜줘야 한다.

만약 해싱된 값이 중복된다면 이를 분리 연결법(Seperate) 혹은 개방 주소형(Open Adressing)으로 관리할 수 있다.

![https://i.imgur.com/U9wtVQ5.png](https://i.imgur.com/U9wtVQ5.png)

![https://i.imgur.com/bDEjxVF.png](https://i.imgur.com/bDEjxVF.png)

### 크로스 집계

트랜잭션 테이블 : 기존 RDB 구조처럼 행을 추가하기에 용이한 테이블

크로스 테이블 : 행과 열이 교차하는 부분에 값이 들어가는 테이블. 열을 추가하기에 용이함

피벗(Pivot) : 행에 있는 값들을 열로 피벗시키면 크로스 테이블이 된다.

트랜잭션(팩트 테이블) → 크로스 테이블로 가는 과정을 `크로스 집계`라고 함. 결국엔 인사이트 추출하는 과정으로 가는 과정인듯

### 룩업 테이블

Join과 똑같다고 보면됨. 테이블끼리 서로 Join시키는 기능

### MPP

RDB는 메모리가 부족하면 성능이 급격히 저하. 그래서 데이터 크기가 매우 큰 건 RDB로는 한계가 명확함. 또한 I/O 작업은 일반적으로 CPU의 싱글코어를 사용함. 

분산된 데이터를 읽어들이러면 멀티 코어 활용하면서 I/O 병렬 처리하는 것이 효과적임. 이를 `MPP` 기술을 사용한다고 함. MPP는 Massive Parallel Processing의 약자로 대규모 분산 처리임 ㅋㅋ

### 행지향, 열지향, 대화형 쿼리엔진

RDB가 `행지향` 데이터베이스임. 행으로 데이터가 쌓임. 기본적으로 하나의 쿼리는 싱글 코어에서 동작하므로 오래 걸리는 작업이 아니면 상관없음.

데이터웨어하우스 같은 애들이 `열지향`임. 열을 기준으로 데이터들을 처리함. 열지향의 장점은 컬럼을 기준으로 묶다보니 데이터 형식이 비슷해 압축이 훨씬 잘됨. 또한 분석할 때 모든 컬럼들을 다 읽지 않는 경우가 많은데, 필요한 컬럼만 접근해서 디스크 I/O를 줄일 수 있음.

Hadoop은 기본적으로 행지향 데이터베이스임. MPP와 유사한 대화형 쿼리엔진(HIve)은 열지향이 아니다보니 완전히 빠르진 않음. 그래서 Hadoop에서 열지향으로 전환하는 라이브러리 만든다고 함.

요약

기본적으로 데이터 분석을 위해선 열지향으로 가는 듯함. 대용량 데이터를 주로 읽는데 사용한다면 압축까지 가능한 열지향이 맞는듯. MPP는 데이터를 처리하는 Processing 방식이라고 생각하면 됨.